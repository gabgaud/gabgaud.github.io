import useBaseUrl from '@docusaurus/useBaseUrl';
import ThemedImage from '@theme/ThemedImage';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Cours 22

# Gestion des stockages sous VMware

* * *

Dans ce cours, nous allons explorer les diff√©rentes solutions de stockage disponibles dans l'environnement VMware ESXi et vCenter. Comme vous avez d√©j√† travaill√© avec Proxmox, vous connaissez les concepts de base de la virtualisation et du stockage. VMware utilise une approche similaire mais avec sa propre terminologie et ses propres technologies.


## Les datastores : concept fondamental üß±

Dans l'√©cosyst√®me VMware, un **datastore** est l'√©quivalent d'un pool de stockage dans Proxmox. C'est un conteneur logique qui abstrait les d√©tails physiques du stockage et fournit un emplacement unifi√© pour stocker les fichiers des machines virtuelles.

Un **datastore** ne correspond pas n√©cessairement √† un disque ni √† une unit√© de stockage particuli√®re, c'est plut√¥t un assemblage de stockages.

### Types de fichiers dans un datastore üìÅ

Lorsque vous cr√©ez une VM dans ESXi, plusieurs fichiers sont automatiquement cr√©√©s dans le datastore. 

Voici les principaux :

    - **Fichiers .vmdk (Virtual Machine Disk)** : <br/>Ce sont vos disques durs virtuels. En r√©alit√©, un disque virtuel est compos√© de deux fichiers :
        - `MaVM.vmdk` : un petit fichier texte descripteur (quelques Ko)
        - `MaVM-flat.vmdk` : le fichier contenant r√©ellement les donn√©es (la taille de votre disque)

    - **Fichiers .vmx (Virtual Machine Configuration)** : <br/>C'est le fichier de configuration de votre VM.
    Il contient toutes les informations : combien de RAM, combien de CPU, quels r√©seaux, etc. C'est un fichier texte que vous pouvez m√™me √©diter manuellement si n√©cessaire (‚ö†Ô∏è mais attention ‚ö†Ô∏è).

    - **Fichiers .nvram** : Stocke les param√®tres du BIOS/UEFI de la VM, comme l'ordre de d√©marrage ou les param√®tres de s√©curit√©.

    - **Fichiers .vswp (Virtual Swap)** : Fichier de m√©moire swap pour la VM. Sa taille est √©gale √† la RAM allou√©e moins la r√©servation de m√©moire.

    - **Fichiers de snapshot** : Quand vous cr√©ez un snapshot, ESXi g√©n√®re des fichiers `-delta.vmdk` et `.vmsd` pour conserver l'√©tat du disque √† un moment pr√©cis.

## Les types de stockage support√©s üíæ

VMware ESXi supporte plusieurs types de stockage, chacun adapt√© √† des besoins et des budgets diff√©rents. Explorons-les en d√©tail.

### Stockage local (Local Storage)

Le stockage local, c'est le plus simple : vous utilisez les disques physiques directement install√©s dans votre serveur ESXi, exactement comme vous le faisiez avec Proxmox.

#### Avantages et inconv√©nients

**<span class='green-text'>Avantages:</span>**
- **Performance maximale** : pas de latence r√©seau, acc√®s direct au disque
- **Configuration simple** : aucune infrastructure r√©seau suppl√©mentaire n√©cessaire
- **Co√ªt minimal** : vous n'achetez que des disques

**<span class='red-text'>Inconv√©nients:</span>**
- **Pas de haute disponibilit√©** : si votre serveur tombe, vos VMs sont inaccessibles
- **Pas de vMotion de stockage** : vous ne pouvez pas d√©placer les VMs vers un autre h√¥te sans arr√™t
- **Capacit√© limit√©e** : vous √™tes limit√© par les baies de disques de votre serveur

#### Quand utiliser le stockage local ?

Le stockage local est parfait pour :
- Les environnements de laboratoire et de test
- Les serveurs autonomes sans besoin de haute disponibilit√©
- Les applications n√©cessitant les meilleures performances possibles
- Les petites infrastructures avec un budget limit√©

#### Proc√©dure : Cr√©er un datastore VMFS local

Mettons en pratique la cr√©ation d'un datastore local. Imaginez que vous venez d'installer un nouveau disque SSD de 500 Go dans votre serveur ESXi.

**√âtape 1 : Connexion et navigation**

Connectez-vous √† votre h√¥te ESXi via le client web (https://adresse-ip-esxi). Une fois connect√© :
- Dans le menu de gauche, cliquez sur "Storage" (Stockage)
- Vous verrez les datastores d√©j√† existants (probablement un datastore par d√©faut cr√©√© lors de l'installation)

**√âtape 2 : V√©rifier que le disque est d√©tect√©**

Avant de cr√©er le datastore, v√©rifions que ESXi voit bien votre nouveau disque :
- Cliquez sur l'onglet "Devices" (P√©riph√©riques)
- Cherchez votre nouveau disque dans la liste (identifiez-le par sa capacit√© et son mod√®le)
- Son statut devrait √™tre "Available" ou "Blank"

Si votre disque n'appara√Æt pas, il peut y avoir un probl√®me de d√©tection mat√©rielle. Red√©marrez l'h√¥te ou v√©rifiez les connexions physiques.