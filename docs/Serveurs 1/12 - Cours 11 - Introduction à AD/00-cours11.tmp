import useBaseUrl from '@docusaurus/useBaseUrl';
import ThemedImage from '@theme/ThemedImage';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Cours 11

## Le DNS jusqu'ici
Jusqu'ici nous avons abordé les DNS avec Linux. En outre, nous avons appris qu'un domaine était un ensemble d'ordinateurs et de périphériques interconnectés les uns aux autres via un réseau local et représenté par une délimitation logique. Chaque appareil possède un nom qui lui est propre sur le domaine, constitué de son nom, suivi du nom de domaine.

**Par exemple:**

<div style={{textAlign: 'center'}}>
<span class="lsp"><span class="yellow-text">**pc0001.**</span><span class="cyan-text">**gabriel.local.**</span></span>
</div><br/>

En jaune, nous avons le nom de l'appareil et en bleu, le nom du domaine. L'ensemble du nom est ce que l'on nomme le FQDN.

## Active Directory

Les services de Domaine Active Directory de Microsoft utilisent les délimitations d'un domaine pour faire l'administration de son contenu. Au-delà des ordinateurs, plusieurs autres objets peuvent faire partie d'un domaine Active Directory (utilisateurs, ordinateurs, imprimantes, etc). Active Directory offre un service centralisé de gestion d'identité, d'autorisation et d'authentification dans un réseau.

### Comment ça marche ?

AD répertorie, dans un annuaire, divers éléments composant le domaine, afin d'en faciliter la recherche:
- Ordinateurs (serveurs et postes de travail)
- Utilisateurs et groupes d'utilisateurs
- Imprimantes
- Dossiers partagés sur le réseau

Cet annuaire est stocké dans une base de données distribuée et répliquée.

### Historique

Active Directory est apparu pour la première fois sous Windows 2000. À l'époque, le leader du produit le plus similaire était Novell Directory. Le fait qu'Active Directory soit directement intégré à Windows a mené à la perte de Novell Directory. Aujourd'hui plus de 90% des organisations et des entreprises utilisent Active Directory pour l'authentification et l'identification de ses utilisateurs.

### Principaux services

|LDAP|DNS|Kerberos|DFS|NTP|
|:--:|:-:|:------:|:-:|:-:|
|Organisation et interrogation des objets (utilisateurs, ordinateurs, groupes, etc.) et leurs attributs dans une base de données de type annuaire.|Résolution de noms des ordinateurs du réseau. Essentiel pour localiser les contrôleurs de domaine et autres serveurs.| Authentification centralisée pour gérer l'accès aux ressources du domaine | Partage de fichiers distribués et répliqués entre plusieurs serveurs mais disposant d'un lien commun.|Synchronisation des horloges système de tous les hôtes du réseau.|

### Qu'est-ce qu'un domaine AD

- Un domaine (zone DNS)
- Un ou plusieurs contrôleurs de domaine
- Des objets de divers types:
    - Utilisateurs
    - Ordinateurs
    - Groupes
    - Stratégies de groupe (GPO)
    - Unités d'organisation (OU)
    - Autres (imprimantes, partage de fichiers...)

<div style={{textAlign: 'center'}}>
    <ThemedImage
        alt="Schéma"
        sources={{
            light: useBaseUrl('/img/Serveurs1/AD_W.svg'),
            dark: useBaseUrl('/img/Serveurs1/AD_D.svg'),
        }}
    />
</div>

### Architecture multi-domaines

Dans certaines entreprises ou organisations, il est possible de créer des infrastructures contenant des domaines et des sous-domaines. Il existe tout un vocabulaire pour décrire ces structures organisationnelles. Pour s'assurer de parler le même langage, il importe de définir quelques termes.


#### Le domaine (racine)

Peut-être l'avez vous déjà remarqué, mais si ce n'est pas le cas, sachez qu'un domaine est toujours représenté par la forme d'un triangle. L'infrastructure AD la plus simple possible est donc représenté par un triangle unique. Il s'agit d'un domaine, une zone DNS, unique dans laquelle nous ferons la gestion de différents objets.

<div style={{textAlign: 'center'}}>
    <ThemedImage
        alt="Schéma"
        sources={{
            light: useBaseUrl('/img/Serveurs1/Domain_W.svg'),
            dark: useBaseUrl('/img/Serveurs1/Domain_D.svg'),
        }}
    />
</div>

:::important
Le premier domaine créé dans une infrastructure Active Directory est appelé: **Le domaine racine.** Ce domaine particulier possède une importance capitale. En effet, le domaine racine est un point central pour la gestion de la sécurité et la structure de la forêt.
:::

#### Le sous-domaine (arbre)

Un sous-domaine est ni plus ni moins qu'un domaine dans un domaine. Dans le cas de *patate.net* par exemple, je pourrais créer un sous-domaine au nom de *quebec.patate.net*. Il existe quelques raisons pour créer un sous-domaine Active Directory:

- La séparation des rôles et des responsabilités.
- La délégation d'administration
- Le contrôle de la sécurité et des stratégies de groupe (GPO)
- Répartition géographique ou organisationnelle
- etc.

<div style={{textAlign: 'center'}}>
    <ThemedImage
        alt="Schéma"
        sources={{
            light: useBaseUrl('/img/Serveurs1/SousDomaine_W.svg'),
            dark: useBaseUrl('/img/Serveurs1/SousDomaine_D.svg'),
        }}
    />
</div>

:::important
On appelle un domaine parent ainsi que tout ses sous-domaines: **un arbre**
:::

#### La forêt

La forêt est l'ensemble des domaines et sous-domaines sous une même administration Active Directory. Elle comprend donc le domaine racine, tous les domaines parents ainsi que leurs domaines enfants.

<div style={{textAlign: 'center'}}>
    <ThemedImage
        alt="Schéma"
        sources={{
            light: useBaseUrl('/img/Serveurs1/InfraAD_W.svg'),
            dark: useBaseUrl('/img/Serveurs1/InfraAD_D.svg'),
        }}
    />
</div>

### Nom du domaine

Un domaine Active Directory possède deux noms:

- Un nom **NETBIOS**:
    - 15 caractères maximum
    - Typiquement en majuscules
    - Sert principalement à assurer une rétrocompatibilité
    - Exemple: LABO

- Nom **DNS**:
    - Zone DNS dédiée au domaine Active Directory
    - Typiquement un sous-domaine de la zone principale
    - Maximum de 253 caractères
    - Exemple: labo.gabriel.local

### Utilisateurs et groupes AD

Le domaine possède sa propre liste d'utilisateurs et de groupes. Ils peuvent être utilisés sur toutes les machines du domaine. 